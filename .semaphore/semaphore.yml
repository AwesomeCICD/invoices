version: v1.0
name: First pipeline example
agent:
  machine:
    type: e1-standard-2
    os_image: ubuntu1804
blocks:
  - name: Build
    task:
      env_vars:
        - name: APP_ENV
          value: prod
      jobs:
        - name: Get Git
          commands:
            - apt update
            - apt install git -yy
        - name: grpc-protocol
          commands:
            - cargo build -p grpc-protocol
      agent:
        machine:
          type: e1-standard-2
          os_image: ubuntu1804
        containers:
          - name: main
            image: externalreality/invoices-build-image
